<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="style.css">
    <script src='app.js'></script>
    <title>Blackjack by Carlos R.</title>
  </head>
  <body>
    <div id='game-container'>
      <button onclick='startGame()'>Start Game</button>
      <div id='player'>
        This is the player div
        <div class='hand'></div>
        <div class='score' id='player-score'></div>
        <button class='user-buttons' onclick="handleHitMe()">Hit Me!</button>
        <button class='user-buttons'onclick="handleStand()"">Stand</button>
        <!-- <button class='user-buttons'>Double Down</button>
        <button class='user-buttons'>Split</button>
        <button class='user-buttons'>Surrender</button> -->
      </div>
      <div id='dealer'>
        This is the dealer div
        <div class='hand'></div>
        <div class='score' id='dealer-score'></div>
      </div>
      <div id='winner'></div>
    </div>
      <script>
        // instantiate new deck
        const blackJack = new BlackJack();
        blackJack.deck.getDeck();
        blackJack.deck.shuffle();
        
        const startGame = () => {
          blackJack.reset();
          disableButtons();
          document.getElementById('dealer-score').innerHTML = '';
          
          blackJack.dealTwo();
          blackJack.getScores();
          displayCards();
          displayPlayerScore();
        }

        const displayCards = () => {
          document.getElementsByClassName('hand')[0].innerHTML = '';
          document.getElementsByClassName('hand')[1].innerHTML = '';

          for(let i = 0; i < blackJack.playerHand.length; i++) {
            const hand = document.getElementsByClassName('hand')[0];
            const newCardDiv = document.createElement('div');
            const newCard = document.createTextNode(JSON.stringify(blackJack.playerHand[i]));

            newCardDiv.appendChild(newCard);
            hand.appendChild(newCardDiv);
          }

          for(let i = 0; i < blackJack.dealerHand.length; i++) {
            const newCardDiv = document.createElement('div');
            const newCard = document.createTextNode(JSON.stringify(blackJack.dealerHand[i]));
            const hand = document.getElementsByClassName('hand')[1];

            newCardDiv.appendChild(newCard);
            hand.appendChild(newCardDiv);
          }
        }

        const disableButtons = () => {
          const userButtons = document.getElementsByClassName('user-buttons');
          if (blackJack.playerBust || blackJack.dealerBust) {
            Object.values(userButtons).forEach(button => {
              button.disabled = blackJack.playerBust || blackJack.dealerBust;
            });
            displayDealerScore();
          } else {
            Object.values(userButtons).forEach(button => {
              button.disabled = blackJack.playerBust || blackJack.dealerBust;
            });
          }
        }

        // const displayNewCard = () => {
        //   const newCardDiv = document.createElement('div');
        //   const newCard = document.createTextNode(JSON.stringify(blackJack.playerHand[blackJack.playerHand.length -1]));
        //   const hand = document.getElementsByClassName('hand')[1];

        //   newCardDiv.appendChild(newCard);
        //   hand.appendChild(newCardDiv);
        // }
        
        const displayPlayerScore = () => {
          document.getElementById('player-score').innerHTML = '';
          const playerScore = document.createTextNode(blackJack.playerScore);
          document.getElementById('player-score').appendChild(playerScore);
        }

        const displayDealerScore = () => {
          document.getElementById('dealer-score').innerHTML = '';
          const dealerScore = document.createTextNode(blackJack.dealerScore);
          document.getElementById('dealer-score').appendChild(dealerScore);
        }

        const handleHitMe = () => { 
          blackJack.hitMe();
          displayCards();
          displayPlayerScore();
          blackJack.isBust();
          disableButtons();
        }

        const handleStand = () => {
          blackJack.stand();
          displayDealerScore();
        }

      </script>
  </body>
</html>